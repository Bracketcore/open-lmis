<!--
  ~ Copyright Â© 2013 VillageReach.  All Rights Reserved.  This Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.
  ~
  ~ If a copy of the MPL was not distributed with this file, You can obtain one at http://mozilla.org/MPL/2.0/.
  -->

<div>
  <h2 openlmis-message="label.warehouse.load.amount"></h2>

  <div class="info-box">
    <div class="row-fluid">
      <div class="span3">
        <strong openlmis-message="label.delivery.zone"> </strong> :&nbsp;<span ng-bind="deliveryZone.name"></span>
      </div>
      <div class="span3">
        <strong openlmis-message="label.program"></strong> :&nbsp;<span ng-bind="program.name"></span>
      </div>
      <div class="span3">
        <strong openlmis-message="label.period"> </strong> :&nbsp;<span ng-bind="period.name"></span>
      </div>
    </div>
  </div>


  <div ng-repeat="geoZoneName in sortedGeoZoneKeys">
    <h3><span ng-bind="geoZoneName"></span></h3>


    <div>
      <table class="table table-bordered">
        <thead ng-model="facilityMap[geoZoneName]">
        <tr>
          <th></th>
          <th></th>
          <th ng-repeat="productGroup in facilityMap[geoZoneName][0].supportedPrograms[0].sortedProductGroup"
              colspan="{{facilityMap[geoZoneName][0].supportedPrograms[0].programProductMap[productGroup].length}}">
            <span ng-bind="productGroup"></span>
          </th>

          <!--<th rowspan="2"
              ng-repeat="productGroup in facilityMap[geoZoneName][0].supportedPrograms[0].sortedProductGroup"
              colspan="{{facilityMap[geoZoneName][0].supportedPrograms[0].programProductMap[productGroup].length}}">
            <table>
              <tr>
                <td
                  colspan="{{facilityMap[geoZoneName][0].supportedPrograms[0].programProductMap[productGroup].length}}">
                  <span ng-bind="productGroup"></span>
                </td>
              </tr>
              <tr>
                <td
                  ng-repeat="programProduct in facilityMap[geoZoneName][0].supportedPrograms[0].programProductMap[productGroup]">
                  <span ng-bind="programProduct.product.primaryName"></span>
                </td>
              </tr>
            </table>
          </th>-->
        </tr>
        <tr>
          <th>
            <span ng-bind="geoZoneLevelName"></span>
          </th>
          <th>
            <span openlmis-message="label.population"></span>
          </th>
          <th ng-repeat="programProduct in getProgramProducts(facilityMap[geoZoneName][0])">
            <span ng-bind="programProduct.product.primaryName"></span>
          </th>
        </tr>
        </thead>
        <tbody>
        <tr ng-repeat="facility in facilityMap[geoZoneName]">
          <td class="span1">
            <span ng-bind="facility.name"></span> <span ng-bind="facility.code"></span>
          </td>
          <td class="span1">
            <span ng-bind="facility.catchmentPopulation"></span>
          </td>

          <td ng-repeat="programProduct in getProgramProducts(facilityMap[geoZoneName][0])">
            <span ng-bind="programProduct.isaAmount"></span>
          </td>

          <!--<td ng-repeat="productGroup in facility.supportedPrograms[0].sortedProductGroup"
              colspan="{{facility.supportedPrograms[0].programProductMap[productGroup].length}}">
            <table>
              <tr>
                <td ng-repeat="programProduct in facility.supportedPrograms[0].programProductMap[productGroup]">
                  <span ng-bind="programProduct.isaAmount"></span>
                </td>
              </tr>
            </table>
          </td>-->
        </tr>
        </tbody>
      </table>
    </div>


  </div>
</div>