<div ng-controller="RequisitionFormController" xmlns="http://www.w3.org/1999/html">
  <div ng-hide="programRnrColumnList">Loading...</div>
  <form name="saveRnrForm" action="#" id="rnr-form" novalidate>
    <div class="rnr-table">
        <ng-include src="'/public/pages/logistics/rnr/partials/rnr-full-supply.html'"></ng-include>
        <ng-include src="'/public/pages/logistics/rnr/partials/rnr-non-full-supply.html'"></ng-include>
    </div>
    <br/>

    <input type="button" ng-click="showAddNonFullSupplyModal()" value="Add Non-Full Supply"
           ng-disabled="!addNonFullSupplyLineItemButtonShown"/>

    <form name="nonFullSupplyForm">
      <div id="nonFullSupplyProductsModal"
           ng-model="nonFullSupplyProductsModal"
           class="fade ng-pristine ng-valid modal hide "
           ui-modal
           data-backdrop="static" data-keyboard="false">
        <div class="modal-header"><h3>Add Non-Full Supply Products</h3></div>
        <div class="modal-body">
          <span class="span3">
            <label for="nonFullSupplyProductsName">Product:</label>
            <select id="nonFullSupplyProductsName" ng-model="facilityApprovedProduct" name="productName"
                    ng-options="facilityApprovedProduct.programProduct.product.primaryName for facilityApprovedProduct in nonFullSupplyProductsToDisplay">
              <option value="">--select product--</option>
            </select>
          </span>
          <span class="span3">
            <label for="nonFullSupplyProductsCode">Product Code:</label>
            <select id="nonFullSupplyProductsCode" ng-model="facilityApprovedProduct" name="productCode"
                    ng-options="facilityApprovedProduct.programProduct.product.code for facilityApprovedProduct in nonFullSupplyProductsToDisplay">
              <option value="">--select product code--</option>
            </select>
          </span>
          <span class="span3">
            <span>
              <label for="quantityRequested"><span
                  ng-bind="labelForRnrColumn('quantityRequested')"></span></label>
              <input name="newNonFullSupply.quantityRequested" ng-model="newNonFullSupply.quantityRequested"
                     id="quantityRequested"
                     rnr-validator="positiveInteger" prevent-rnr-error="true" maxlength="8"/><br>
              <span class="rnr-form-error" style="display:none;" id="newNonFullSupply.quantityRequested">
                Enter Numeric Data
              </span>
            </span>
          </span>
          <span class="span3">
            <label for="reasonForRequestedQuantity"><span
                ng-bind="labelForRnrColumn('reasonForRequestedQuantity')"></span></label>
            <textarea maxlength="250" rows="4" ng-model="newNonFullSupply.reasonForRequestedQuantity"
                      id="reasonForRequestedQuantity"></textarea><br>
            <span class="alert alert-warning reason-request"
                  ng-show="newNonFullSupply.quantityRequested && !newNonFullSupply.reasonForRequestedQuantity">
              Please enter a reason
            </span>
          </span>
        </div>

        <div class="modal-footer">
          <span class="pull-left span1">
            <input type="button" href="" class="btn btn-primary" ng-click="addNonFullSupplyLineItem()"
                   ng-disabled="!(newNonFullSupply.quantityRequested && newNonFullSupply.reasonForRequestedQuantity
             && facilityApprovedProduct)" value="Add"/>
          </span>

          <span class="pull-left span1">
            <input type="reset" data-dismiss="modal" class="btn btn-success save-button"
                   value="Close"/>
          </span>
        </div>

      </div>
    </form>


    <div form-toolbar id="action_buttons" class="action-buttons">
      <div class="total-cost-container">
        <div class="cost-values">
          <small>
            Total Cost For Full Supply Items:
            <strong>
              <span id="fullSupplyItemsCostCurrency" class="cell-text" ng-bind="currency"></span><span
                id="fullSupplyItemsCost" class="cell-text" ng-bind="rnr.fullSupplyItemsSubmittedCost"></span>
            </strong>
            &nbsp;|&nbsp;
            Total Cost For Non Full Supply Items:
            <strong>
              <span id="nonFullSupplyItemsCostCurrency" class="cell-text" ng-bind="currency"></span><span
                id="nonFullSupplyItemsCost" class="cell-text"
                ng-bind="rnr.nonFullSupplyItemsSubmittedCost"></span>
            </strong>
          </small>
          &nbsp;|&nbsp;
          <strong>
            Total R&amp;R Cost:
            <span id="totalCostCurrency" class="cell-text" ng-bind="currency"></span>
            <span id="totalCost" class="cell-text" ng-bind="totalCost()"></span>
          </strong>
        </div>
      </div>
      <div class="form-cell button-row">
        <input ng-disabled="formDisabled" type="button" ng-click="saveRnr()" class="btn btn-primary save-button"
               value="Save"/>
        <input ng-show="rnr.status == 'INITIATED' && hasPermission('CREATE_REQUISITION')" ng-disabled="formDisabled"
               type="button" ng-click="submitRnr()" class="btn btn-success submit-button" value="Submit"/>
        <input type="button"
               ng-show="(rnr.status == 'SUBMITTED' || rnr.status == 'AUTHORIZED') && hasPermission('AUTHORIZE_REQUISITION')"
               ng-disabled="rnr.status == 'AUTHORIZED'" ng-click="authorizeRnr()"
               class="btn btn-success submit-button"
               value="Authorize"/>
      </div>
      <div class="toolbar-error" id="saveFailMessage" ng-bind="error"
           ng-show="error && !submitError && !submitMessage"></div>
      <div class="toolbar-error" id="submitFailMessage" ng-bind="submitError" ng-show="submitError"></div>
      <div class="toolbar-success" id="saveSuccessMsgDiv" ng-bind="message"
           ng-show="!submitMessage && !submitError && message"></div>
      <div class="toolbar-success" id="submitSuccessMsgDiv" ng-bind="submitMessage"
           ng-show="submitMessage"></div>
    </div>
  </form>
</div>
