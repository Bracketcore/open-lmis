<!DOCTYPE html>

<!--
  ~ Electronic Logistics Management Information System (eLMIS) is a supply chain management system for health commodities in a developing country setting.
  ~
  ~ Copyright (C) 2015  John Snow, Inc (JSI). This program was produced for the U.S. Agency for International Development (USAID). It was prepared under the USAID | DELIVER PROJECT, Task Order 4.
  ~
  ~ This program is free software: you can redistribute it and/or modify it under the terms of the GNU Affero General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.
  ~
  ~ This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Affero General Public License for more details.
  ~
  ~ You should have received a copy of the GNU Affero General Public License along with this program.  If not, see <http://www.gnu.org/licenses/>.
  -->

<script id="template/accordion/accordion.html" type="text/ng-template">
    <div class="accordion" ng-transclude></div>
</script>

<script id="template/accordion/accordion-group.html" type="text/ng-template">
    <div class="accordion-group">
        <div class="accordion-heading" style="margin-bottom:0; border-bottom:0">
           <a style="bottom:0" class="accordion-toggle" ng-class="{'collapsed':!isOpen,'open':isOpen}" ng-click="isOpen = !isOpen" accordion-transclude="heading">{{heading}}</a>
        </div>
        <div class="accordion-body" style="display:block; margin-bottom:0" collapse="!isOpen">

            <div class="accordion-inner" ng-transclude></div>  </div>
    </div>
</script>


<script type="text/ng-template" id="product-summary">
    <div style="width: 600px;">
        <div class="triangle"></div>
        <div class="ns-popover-tooltip">

            <tabset class="table">
                <tab>
                    <tab-heading style="cursor: pointer;"><span openlmis-message="title.overview"></span></tab-heading>
                    <table style="width: 100%;">
                        <thead>
                        <tr class="gradient-header">
                            <th openlmis-message="label.items"></th>
                            <th openlmis-message="label.this.period"></th>
                            <th openlmis-message="label.last.period"></th>
                        </tr>

                        </thead>
                        <tr ng-repeat="item in productSummary">
                            <td>{{item.label}}</td>
                            <td>{{item.this_period}}</td>
                            <td>{{item.last_period}}</td>
                        </tr>
                    </table>

                </tab>
                <tab>
                    <tab-heading style="cursor: pointer;"><span openlmis-message="title.legend"></span></tab-heading>
                    <table class="table">
                        <thead>
                        <tr class="gradient-header">
                            <th openlmis-message="title.legend"></th>
                            <th openlmis-message="title.definition"></th>
                        </tr>
                        </thead>
                        <tr ng-repeat="def in definitions">
                            <td>{{def.label}}</td>
                            <td>{{def.definition}}</td>
                        </tr>
                    </table>

                </tab>
            </tabset>

        </div>
    </div>

</script>

<script type="text/ng-template" id="consumption-chart-info">
        <!--<div class="triangle" style="margin-left: -7px;"></div>-->
        <div class="ns-popover-tooltip">
            <span openlmis-message="message.consumption.chart.info"></span>
        </div>
</script>
<script type="text/ng-template" id="stocking-chart-info">
    <!--<div class="triangle" style="margin-left: -7px;"></div>-->
    <div class="ns-popover-tooltip">
        <span openlmis-message="message.stocking.chart.info"></span>
    </div>
</script>
<script type="text/ng-template" id="losses-chart-info">
    <!--<div class="triangle" style="margin-left: -7px;"></div>-->
    <div class="ns-popover-tooltip">
        <span openlmis-message="message.losses.chart.info"></span>
    </div>
</script>

<script type="text/ng-template" id="facilities-stock-out">
    <div style="width: 600px;">
        <div class="triangle"></div>
        <div class="ns-popover-tooltip" style="max-height: 300px; overflow-y: scroll;">
            <table style="width: 100%; " class="table">
                <thead>
                <tr class="gradient-header">
                    <th openlmis-message="label.facility" rowspan="2"></th>
                    <th openlmis-message="label.stock.on.hand" colspan="2"></th>
                </tr>
                <tr class="gradient-header">
                    <th openlmis-message="label.this.period"></th>
                    <th openlmis-message="label.last.period"></th>
                </tr>

                </thead>
                <tbody>
                <tr ng-repeat="facility in facilities">
                    <td>{{facility.facility_name}}</td>
                    <td>{{facility.stock_in_hand}}</td>
                    <td>{{facility.previous_stock_in_hand}}</td>
                </tr>
                </tbody>

            </table>

        </div>
    </div>

</script>

<div xmlns="http://www.w3.org/1999/html">

    <ng-include src="'/public/pages/dashboard/shared/dashboard-header_new.html'"></ng-include>
      <div class="reporting-header">
          <span><span>Total:</span> {{reportingPerformance.total}}</span>
          <span><span>Expected To Report:</span> {{reportingPerformance.expected}}</span>
          <span><span>Ever Reported:</span> {{reportingPerformance.ever}}</span>
          <span><span>Reported This Period:</span> {{reportingPerformance.period}}</span>
          <span><span>Late Reported:</span> {{reportingPerformance.late}}</span>
        </div>
    <div class="row-fluid">
        <div class="span2" style="border-right: solid 1px #EAEFF3">
            <div>
                <div ng-repeat="product in productsTrend">
                    <div style="padding: 10px 30px; border-bottom: solid 1px #EAEFF3; max-width: 100px;">

                        <div style="text-align: center; cursor: pointer;">
                            <input type="checkbox" ng-model="product.selected"  style="float: left; margin-top: 3px"/>
                            <span  ns-popover ng-click="getProductSummary(product.code)"
                                   ns-popover-template="product-summary"
                                   ns-popover-trigger="click"
                                   ns-popover-theme="ns-popover-tooltip-theme"
                                   ns-popover-timeout="1000"
                                   ns-popover-placement="{{adjustPlacement($index)}}"
                                   ns-popover-hide-on-inside-click="false"
                                   ns-popover-hide-on-outside-click="true"
                                   ns-popover-hide-on-button-click="true" style="cursor: pointer; padding: 10px 0px;"> {{product.name}}</span>

                        </div>
                        <spark-line af-data="product.sohTrend" af-option="sparkOption" style="margin-top:5px;"></spark-line>
                        <div style="margin-top:5px; text-align: center">
                            <div ns-popover ng-click="getFacilitiesStockedOut(product.code)"
                                 ns-popover-template="facilities-stock-out"
                                 ns-popover-trigger="click"
                                 ns-popover-theme="ns-popover-tooltip-theme"
                                 ns-popover-timeout="1000"
                                 ns-popover-placement="{{adjustPlacement($index)}}"
                                 ns-popover-hide-on-inside-click="false"
                                 ns-popover-hide-on-outside-click="true"
                                 ns-popover-hide-on-button-click="true" style="cursor: pointer; padding: 10px 0px;">
                                <span ng-class="product.color"
                                      style="  color:white; padding:2px 20px; border-radius:10px; font-size:12px;">{{product.facilityStockedOut | number}}</span>
                            </div>

                        </div>


                    </div>

                </div>
            </div>
        </div>
        <div class="span10">

            <div class="row-fluid" ng-repeat="product in productsTrend" ng-if="product.selected" >
                <div class="span4" >
                    <accordion>
                        <accordion-group class="gray-cascade" is-open="product.consumptionChart.openPanel">
                            <accordion-heading >
                                <div class="accordion-title">
                                    <div class="caption">

                                        <span >Consumption : {{product.name}}  </span>
                                    </div>
                                    <div class="tools">
                                        <i  ng-class="'icon-info-sign'" ns-popover ns-popover-template="consumption-chart-info" ns-popover-trigger="mouseenter" ns-popover-theme="ns-popover-tooltip-theme" ns-popover-placement="bottom|right"></i>
                                        <i  ng-class="{'icon-minus-sign': product.consumptionChart.openPanel, 'icon-plus-sign': !product.consumptionChart.openPanel}"></i>
                                    </div>
                                </div>
                            </accordion-heading>
                            <!-- <c3chart bindto-id="dynamicpie" chart-data="piePoints" chart-columns="pieColumns"
                                      callback-function="handleCallback"/>-->
                            <c3chart bindto-id="{{product.name}}_consumption_chart">
                                <chart-axes values-x="x" />
                                <chart-axis >
                                    <chart-axis-x axis-position="outer-center" axis-label="Period"
                                                  axis-type="category" >
                                        <chart-axis-x-tick tick-rotate="50" />
                                    </chart-axis-x>
                                </chart-axis>

                                <chart-column column-id="Consumption"
                                              column-values="{{product.consumption}}"
                                              column-type="bar"/>
                                      <chart-column column-id="amc"
                                                    column-values="{{product.amc}}"
                                                    column-type="line"/>
                                <chart-column column-id="x"
                                              column-values="{{product.periods}}"/>
                            </c3chart>
                        </accordion-group>
                    </accordion>
                </div>
                <div class="span4">
                    <accordion>
                        <accordion-group class="gray-cascade" is-open="product.stockingEfficiencyChart.openPanel">
                            <accordion-heading >
                                <div class="accordion-title">
                                    <div class="caption">
                                        <span >Stock Efficiency : {{product.name}}</span>
                                    </div>
                                    <div class="tools">
                                        <i  ng-class="'icon-info-sign'" ns-popover ns-popover-template="stocking-chart-info" ns-popover-trigger="mouseenter" ns-popover-theme="ns-popover-tooltip-theme" ns-popover-placement="bottom|right"></i>
                                        <i  ng-class="{'icon-minus-sign': product.stockingEfficiencyChart.openPanel, 'icon-plus-sign': !product.stockingEfficiencyChart.openPanel}"></i>
                                    </div>
                                </div>
                            </accordion-heading>
                            <c3chart bindto-id="{{product.name}}_stockingefficiency_chart">
                                <chart-axes values-x="x" />
                                <chart-axis >
                                    <chart-axis-x axis-position="outer-center" axis-label="Period"
                                                  axis-type="category" >
                                        <chart-axis-x-tick tick-rotate="50" />
                                    </chart-axis-x>
                                </chart-axis>

                                <chart-column column-id="Over Stocked"
                                              column-values="{{product.overStocked}}"
                                              column-type="bar"/>
                                <chart-column column-id="Adequetly Stocked"
                                              column-values="{{product.adequetlyStocked}}"
                                              column-type="bar"/>
                                <chart-column column-id="Understocked"
                                              column-values="{{product.understocked}}"
                                              column-type="bar"/>
                                <chart-column column-id="Stocked Out"
                                              column-values="{{product.stockedout}}"
                                              column-type="bar"/>
                                <chart-column column-id="x"
                                              column-values="{{product.periods}}"/>
                            </c3chart>
                        </accordion-group>
                    </accordion>
                </div>
                <div class="span4">
                    <accordion>
                        <accordion-group class="gray-cascade" is-open="product.lossesAndAdjustmentChart.openPanel">
                            <accordion-heading >
                                <div class="accordion-title">
                                    <div class="caption">

                                        <span >Losses And Adjustment : {{product.name}}</span>
                                    </div>
                                    <div class="tools">
                                        <i  ng-class="'icon-info-sign'" ns-popover ns-popover-template="losses-chart-info" ns-popover-trigger="mouseenter" ns-popover-theme="ns-popover-tooltip-theme" ns-popover-placement="bottom|right"></i>
                                        <i  ng-class="{'icon-minus-sign': product.lossesAndAdjustmentChart.openPanel, 'icon-plus-sign': !product.lossesAndAdjustmentChart.openPanel}"></i>
                                    </div>
                                </div>
                            </accordion-heading>
                            <!-- <c3chart bindto-id="dynamicpie" chart-data="piePoints" chart-columns="pieColumns"
                                      callback-function="handleCallback"/>-->
                            <c3chart bindto-id="{{product.name}}_losses_and_adjustment_chart">
                                <chart-axes values-x="x" />
                                <chart-axis >
                                    <chart-axis-x axis-position="outer-center" axis-label="Period"
                                                  axis-type="category" >
                                        <chart-axis-x-tick tick-rotate="50" />
                                    </chart-axis-x>
                                </chart-axis>

                                <chart-column column-id="Quantity Lost"
                                              column-values="{{product.quantityLost}}"
                                              column-type="bar"/>
                                <chart-column column-id="Quantity Damaged"
                                              column-values="{{product.quantityDamaged}}"
                                              column-type="bar"/>
                                <chart-column column-id="Quantity Expired"
                                              column-values="{{product.quantityExpired}}"
                                              column-type="bar"/>
                                <chart-column column-id="x"
                                              column-values="{{product.periods}}"/>
                            </c3chart>
                        </accordion-group>
                    </accordion>
                </div>
            </div>
            <!--<div class="row-fluid">

                <div class="span4">
                    <accordion>
                        <accordion-group class="gray-cascade" is-open="districtReporting.openPanel">
                            <accordion-heading >
                                <div class="accordion-title">
                                    <div class="caption">

                                        <span openlmis-message="label.pie"></span>
                                    </div>
                                    <div class="tools">
                                        <i  ng-class="'fa fa-info'" ng-mouseover="alertMsg()">
                                        </i>
                                        <i  ng-class="{'icon-minus-sign': districtReporting.openPanel, 'icon-plus-sign': !districtReporting.openPanel}"></i>
                                    </div>
                                </div>
                            </accordion-heading>
                           &lt;!&ndash; <c3chart bindto-id="dynamicpie" chart-data="piePoints" chart-columns="pieColumns"
                                     callback-function="handleCallback"/>&ndash;&gt;
                            <c3chart bindto-id="consumption-amc-chart">
                                <chart-column column-id="data 1"
                                              column-values="{{xyz}}"
                                              column-type="bar"/>
                          &lt;!&ndash;      <chart-column column-id="data 2"
                                              column-values="50,20,10,40,15,25"
                                              column-type="line"/>&ndash;&gt;
                            </c3chart>

                        </accordion-group>
                    </accordion>
                </div>
                <div class="span4">
                    <accordion>
                        <accordion-group class="gray-cascade" is-open="stocking.openPanel">
                            <accordion-heading>
                                <div class="accordion-title">
                                    <div class="caption">

                                        <span openlmis-message="label.line"></span>
                                    </div>
                                    <div class="tools">

                                        <i  ng-class="{'icon-minus-sign': stocking.openPanel, 'icon-plus-sign': !stocking.openPanel}"></i>
                                    </div>
                                </div>
                            </accordion-heading>
                            <c3chart bindto-id="stock-efficiency-chart" show-labels="true">
                                <chart-axes values-x="x" />

                                <chart-axis >
                                    <chart-axis-x axis-position="outer-center" axis-label="Period"
                                                  axis-type="category" >
                                        <chart-axis-x-tick tick-rotate="50" />
                                    </chart-axis-x>
                                </chart-axis>
                                <chart-column column-id="x"
                                              column-values="period 10,period 20,period 30,period 40,period 50,period 60"/>

                                <chart-column column-id="data 1"
                                              column-values="30,200,100,400,150,250"
                                              column-type="bar"/>
                                <chart-column column-id="data 2"
                                              column-values="50,20,10,40,15,25"
                                              column-type="bar"/>
                                <chart-column column-id="data 3"
                                              column-values="55,10,30,4,16,75"
                                              column-type="bar"/>
                                <chart-column column-id="data 4"
                                              column-values="25,15,39,40,56,95"
                                              column-type="bar"/>
                            </c3chart>
                        </accordion-group>
                    </accordion>

                </div>
                <div class="span4">
                    <accordion>
                        <accordion-group class="gray-cascade" is-open="stocking.openPanel">
                            <accordion-heading>
                                <div class="accordion-title">
                                    <div class="caption">

                                        <span openlmis-message="label.bar"></span>
                                    </div>
                                    <div class="tools">

                                        <i  ng-class="{'icon-minus-sign': stocking.openPanel, 'icon-plus-sign': !stocking.openPanel}"></i>
                                    </div>
                                </div>
                            </accordion-heading>
                            <c3chart bindto-id="losses-chart">
                                <chart-column column-id="data 1"
                                              column-values="30,200,100,400,150,250"
                                              column-type="bar"/>
                                <chart-column column-id="data 2"
                                              column-values="50,20,10,40,15,25"
                                              column-type="bar"/>
                                <chart-column column-id="data 3"
                                              column-values="55,10,30,4,16,75"
                                              column-type="bar"/>
                            </c3chart>
                        </accordion-group>
                    </accordion>

                </div>

            </div>
            <div class="row-fluid">

                <div class="span6">
                    <accordion>
                        <accordion-group class="gray-cascade" is-open="stocking.openPanel">
                            <accordion-heading>
                                <div class="accordion-title">
                                    <div class="caption">

                                        <span openlmis-message="label.bar"></span>
                                    </div>
                                    <div class="tools">

                                        <i  ng-class="{'icon-minus-sign': stocking.openPanel, 'icon-plus-sign': !stocking.openPanel}"></i>
                                    </div>
                                </div>
                            </accordion-heading>

                            <c3chart bindto-id="stacked-bar-plot1-chart" chart-data="piePoints" chart-columns="barColumns">
                            </c3chart>
                        </accordion-group>
                    </accordion>

                </div>

                <div class="span6">
                    <accordion>
                        <accordion-group class="gray-cascade" is-open="stocking.openPanel">
                            <accordion-heading>
                                <div class="accordion-title">
                                    <div class="caption">

                                        <span openlmis-message="label.donut"></span>
                                    </div>
                                    <div class="tools">

                                        <i  ng-class="{'icon-minus-sign': stocking.openPanel, 'icon-plus-sign': !stocking.openPanel}"></i>
                                    </div>
                                </div>
                            </accordion-heading>

                            <c3chart bindto-id="donat-plot1-chart" chart-data="piePoints" chart-columns="donutColumns">
                            </c3chart>
                        </accordion-group>
                    </accordion>

                </div>
            </div>
            <div class="row-fluid">

                <div class="span6">
                    <accordion>
                        <accordion-group class="gray-cascade" is-open="stocking.openPanel">
                            <accordion-heading>
                                <div class="accordion-title">
                                    <div class="caption">

                                        <span openlmis-message="label.gauge"></span>
                                    </div>
                                    <div class="tools">

                                        <i  ng-class="{'icon-minus-sign': stocking.openPanel, 'icon-plus-sign': !stocking.openPanel}"></i>
                                    </div>
                                </div>
                            </accordion-heading>

                            <c3chart bindto-id="gauge-plot1-chart">
                                <chart-column column-id="Data 1"
                                              column-values="70"
                                              column-type="gauge"/>
                                <chart-gauge min="50"
                                             max="75"
                                             units=" hours"
                                             width="39"/>
                            </c3chart>
                        </accordion-group>
                    </accordion>

                </div>
            </div>
-->

        </div>
    </div>

</div>
<div id="flotTip"></div>