<!--
  ~ Copyright Â© 2013 VillageReach.  All Rights Reserved.  This Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.
  ~
  ~ If a copy of the MPL was not distributed with this file, You can obtain one at http://mozilla.org/MPL/2.0/.
  -->

<div ng-hide="rights && role">Loading...</div>
<div ng-show="rights && role">
  <div ng-hide="role.id"><h2>Add new role</h2></div>
  <div ng-show="role.id"><h2>Edit role</h2></div>
  <form ng-submit="saveRole()" id="create-role" name="roleForm" novalidate>
    <div class="app-form roles-form">

      <div class="row-fluid clearfix">
        <div class="span5">
          <label for="name">Role name <span class="label-required">*</span></label>

          <div>
            <input ng-model="role.name" name="name" id="name" type="text" maxlength="50"
                   ng-required="true"/>
            <span class="field-error" ng-show="roleForm.name.$error.required && showError">
              Please fill this value
            </span>
          </div>
        </div>
      </div>

      <div class="row-fluid clearfix">
        <div class="span5">
          <label for="description">Role description</label>

          <div>
            <input ng-model="role.description" name="description" id="description" type="text"
                   maxlength="250"/>
          </div>
        </div>
      </div>
      <div class="row-fluid clearfix">
        <div>
          <label>Type of role <span class="label-required">*</span> <span class="roles-note">(individual roles cannot be a mix of the two types)</span></label>

          <div class="radio-group">
            <div class="form-inline">
              <input id="adminRoleType" type="radio" name="adminRoleType" value="true" ng-model="role.adminRole" ng-change="showRoleTypeModal(true)"/>
              <label for="adminRoleType">Admin and general operations role</label>
            </div>
            <div class="form-inline">
              <input id="programRoleType" type="radio" name="programRoleType" value="false" ng-model="role.adminRole" ng-change="showRoleTypeModal(false)"/>
              <label for="programRoleType">Program and facility-based role</label>
            </div>
          </div>

        </div>
      </div>

      <div class="form-group clearfix">
        <h3>Assigned rights<span class="label-required">*</span></h3>

        <div class="assigned-rights" ng-class="{'is-disabled': role.adminRole == 'false'}">
          <h4>Admin and general operations rights</h4>
          <div class="rights-list">
            <div id="rights-{{right.right}}" class="checkbox-list clearfix" ng-repeat="right in adminRights">
              <input id="{{right.right}}" type="checkbox" ng-checked="contains(right.right)"
                     ng-click="updateRights(checked,right)" ng-model="checked"
                     ng-disabled="areRelatedFieldsSelected(right) || role.adminRole == 'false'"/>
              <label for="{{right.right}}">{{right.rightName}}</label>
            </div>
          </div>
          <span class="field-error" ng-show="showRightError && role.adminRole=='true'">
              Please select at least one right for the role
            </span>
        </div>

        <div class="assigned-rights" ng-class="{'is-disabled': role.adminRole == 'true'}">
          <h4>Program and facility-based rights</h4>
          <div id="nonAdminRights-{{nonAdminRight.right}}" class="checkbox-list clearfix" ng-repeat="nonAdminRight in nonAdminRights">
            <input id="{{nonAdminRight.right}}" type="checkbox" ng-checked="contains(nonAdminRight.right)"
                   ng-click="updateRights(checked,nonAdminRight)" ng-model="checked"
                   ng-disabled="areRelatedFieldsSelected(nonAdminRight) || role.adminRole == 'true'"/>
            <label for="{{nonAdminRight.right}}">{{nonAdminRight.rightName}}</label>
          </div>
            <span class="field-error" ng-show="showRightError && role.adminRole=='false'">
              Please select at least one right for the role
            </span>
        </div>

      </div>

      </div>

      <div form-toolbar id="action_buttons" class="action-buttons">
        <div class="form-cell button-row pull-left">
          <input type="submit" class="btn btn-primary save-button" value="Save"/>
          <a type="button" ng-href="#/list" class="btn btn-cancel submit-button">Cancel</a>
        </div>
      </div>
      <div class="toolbar-error" id="saveFailMessage" ng-bind="error" ng-show="error"></div>
    </div>
  </form>
</div>


