<!--
~ This program was produced for the U.S. Agency for International Development. It was prepared by the USAID | DELIVER PROJECT, Task Order 4. It is part of a project which utilizes code originally licensed under the terms of the Mozilla Public License (MPL) v2 and therefore is licensed under MPL v2 or later.
~
~ This program is free software: you can redistribute it and/or modify it under the terms of the Mozilla Public License as published by the Mozilla Foundation, either version 2 of the License, or (at your option) any later version.
~
~ This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the Mozilla Public License for more details.
~
~ You should have received a copy of the Mozilla Public License along with this program. If not, see http://www.mozilla.org/MPL/
-->
<style>
 #repair-management{
    width:180px;
    height:180px;
   margin:0px 0px;
    position:relative;
    }
#repairManagementReportLegend{clear:both}
    #repair-management  .flot-base{
    margin:0px 0px;
    position:relative;}

  tbody  tr:hover {
    background-color: #EEE;
    }
    .modal {

    margin: -250px 0 0 -620px;
    overflow: auto;

    }
    user agent stylesheetdiv {
    display: block;
    }
</style>

<div class="alert alert-success" id="saveSuccessMsgDiv" ng-bind="message" ng-show="message"/>
<div class="row-fluid sortable ui-sortable">
    <div class="box span12">
        <div class="box-header">
            <h2 openlmis-message="report.title.repair.management">
                <i class="icon-edit"></i>
                <span class="break"></span></h2>
            <div class="box-icon">
                <a ng-click="section(0)" ng-show="show(1)" class="btn-minimize"><i class="icon-chevron-up"></i></a>
                <a ng-click="section(1)"  ng-show="show(0)" class="btn-minimize"><i class="icon-chevron-down"></i></a>
                <a id="pdf-button" href="#list" ng-click="exportReport('pdf')" class='btn-small btn-info'>PDF</a>
                <a id="xls-button" href="#list" ng-click="exportReport('xls')" class='btn-small btn-info'>Excel</a>
            </div>
        </div>
        <div>
            <div class="app-form"  style="padding: 1px;">
                <form ng-submit="filterGrid()"  name="filterForm" novalidate>
                    <div filter-container class="clearfix">
                       <program-filter class="form-cell horizontalFilters"></program-filter>
                       <!--<zone-filter class="form-cell horizontalFilters"></zone-filter>-->
                        <facility-type-filter id="facility_type" class="form-cell horizontalFilters"></facility-type-filter>
                        <div class="form-cell horizontalFilters">
                            <label class="labels"><span openlmis-message="label.repair.management.type"></span></label>
                            <div class="form-field">
                                <select ui-select2 ng-model="filter.aggregate" ng-change="filterChanged()" style="width:200px;" name="status"   >
                                    <option ng-selected="option.value==filter.aggregate.default"  ng-repeat="option in types" value="{{ option.value }}">{{ option.name }}</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
       <div> <strong>Sorting:</strong>
        <table client-side-sort-pagination class="table table-bordered" ng-show="data == undefined || data.length == 0">
            <tr>
                <td><span openlmis-message="label.report.nodata"></span></td>
            </tr>
        </table>
      </div>
        <div ng-show="datarows.length > 0">
            <div class="row-fluid">
                <div class="span8">
                <div class="pull-right legend" >Page: {{tableParams.page}}, Showing records {{ ((tableParams.page - 1) * tableParams.count) + 1 }} to {{ (tableParams.page ) * tableParams.count }} of {{tableParams.total}} </div>
                <table ng-show="datarows.length > 0" class="table-bordered table table-striped pull-right" ng-table="tableParams">
                    <tbody>
                    <tr  ng-repeat="row in datarows" ng-click="loadPieChart(row)" style="cursor:pointer">
                        <td  data-title="'#'" class="number" style="width:20px" >{{ row.no }}</td>
                        <td  data-title="getLocalMessage('label.repair.management.facilityname')" style="max-width:80px" sortable="facility_name" ng-show="!aggregate" >{{ row.facility_name}}</td>
                        <td data-title="getLocalMessage('label.repair.management.facilitytype')" style="max-width:80px" sortable="facility_type" ng-show="!aggregate" >{{ row.facility_type}}</td>
                        <td data-title="getLocalMessage('label.repair.management.facilitytype')" style="max-width:80px" sortable="facility_type" ng-show="aggregate" ><span openlmis-message="label.facility.type.all"></span> {{aggregateType }}</td>
                        <td data-title="getLocalMessage('label.repair.management.functional')" style="max-width:80px" sortable="functional" >{{ row.functional}}</td>
                        <td data-title="getLocalMessage('label.repair.management.notfunctional')" style="max-width:100px" sortable="not_functional" >{{ row.not_functional }}</td>
                        <td data-title="getLocalMessage('label.repair.management.functionalnotinstalled')" style="max-width:150px" sortable="functional_not_installed" >{{ row.functional_not_installed }}</td>
                        <td data-title="getLocalMessage('label.repair.management.electricity')" style="max-width:80px" sortable="electricity"  >{{ row.electricity }}</td>
                        <td data-title="getLocalMessage('label.repair.management.solar')" style="max-width:100px" sortable="solar"  >{{ row.solar }}</td>
                        <td data-title="getLocalMessage('label.repair.management.gas')" style="max-width:100px" sortable="gas"  >{{ row.gas }}</td>
                        <td data-title="getLocalMessage('label.repair.management.kerosene')" style="max-width:100px" sortable="kerosene"  >{{ row.kerosene }}</td>
                    </tr>
                    </tbody>
                </table>
                </div>
                <div class="span4" ng-show="pieChart">
                 <div ng-show="RepairManagementPieChartData.length > 0">

                     <label class="labels" style="text-align: center;font-family: bold" >{{facilityName}}</span></label>

                     <dv style="float:left">
                         <a-float id="repair-management" style="align-items: center" af-option="RepairManagementPieChartOption" af-data="RepairManagementPieChartData" class="chart"></a-float>
                     </dv>

                     <dv style="float:right" ng-show="notFunctional">
                         <a-float id="repair-management" style="align-items: center" af-option="RepairManagementNotFunctionalPieChartOption" af-data="RepairManagementNotFunctionalPieChartData" class="chart"></a-float>
                     </dv>
                     <div id="repairManagementReportLegend" class="chartLegend"></div>
                     <div id="repairManagementNotFunctionalReportLegend" class="chartLegend"></div>
                 </div>
                 </div>
                </div>
            </div>
        </div>

    </div>
<div id="equipmentDialogDiv" style="width:auto" modal="equipmentDialogModal" options="{'backdrop':'static', 'escape':false}">
    <div class="modal-header" style="clear:both">
        <span style="width:300px;float:left">
         <h3 openlmis-message="label.equipment.list"></h3>
        </span>
        <span class="box-icon span2"  style="float:right;clear:both">
            <a id="pdf-button2" href="#list" ng-click="exportReport('pdf')" class='btn-small btn-info'>PDF</a>
            <a id="xls-button2" href="#list" ng-click="exportReport('xls')" class='btn-small btn-info'>Excel</a>
        </span>
    </div>
    <div class="modal-body">
        <form name="addEquipmentForm">
                <div class="row-fluid">
                    <div class="span12">
                    <div class="pull-right legend" >Page: {{equipments.page}}, Showing records {{ ((tableParams.page - 1) * tableParams.count) + 1 }} to {{ (tableParams.page ) * tableParams.count }} of {{equipments.total}} </div>
                    <table ng-show="equipments.rows.length > 0" class="table-bordered table table-striped pull-right" ng-table="tableParams">
                        <tbody>
                        <tr  ng-repeat="row in equipments.rows"  style="cursor:pointer">
                            <td  data-title="'#'" class="number" style="width:20px" >{{row.no}}</td>
                            <td  data-title="getLocalMessage('label.region')" style="max-width:80px" sortable="region"  >{{ row.region}}</td>
                            <td data-title="getLocalMessage('label.district')" style="max-width:80px" sortable="district"  >{{ row.district}}</td>
                            <td data-title="getLocalMessage('label.facility.name')" style="max-width:80px" sortable="facility_name"  >{{ row.facility_name }}</td>
                            <td data-title="getLocalMessage('label.facility.type')" style="max-width:80px" sortable="facility_type" >{{ row.facility_type}}</td>
                            <td data-title="getLocalMessage('label.equipment.manufacturer')" style="max-width:100px" sortable="manufacturer" >{{ row.manufacturer }}</td>
                            <td data-title="getLocalMessage('label.equipment.model')" style="max-width:150px" sortable="model" >{{ row.model }}</td>
                            <td data-title="getLocalMessage('label.equipment.capacity')" style="max-width:150px" sortable="capacity" >{{ row.capacity }}</td>
                            <td data-title="getLocalMessage('label.equipment.working.status')" style="max-width:80px" sortable="working_status"  >{{ row.working_status }}</td>
                            <td data-title="getLocalMessage('label.equipment.breakdown')" style="max-width:100px" sortable="break_down"  >{{ row.break_down }}</td>
                        </tr>
                        </tbody>
                    </table>
                        <h4 >
                            <span  class="label label-default"><span openlmis-message="label.repair.management.totalcapacity"></span>:</span>
                            <span  class="label label-primary">{{capacity[0].totalCapacity}}</span>
                        </h4>
                    </div>
                </div>
        </form>

    </div>

    <div class="modal-footer">
        <input type="button"  ng-click="closeModal()"  class="btn btn-cancel" openlmis-message="button.close"/>
    </div>

</div>



</div>



