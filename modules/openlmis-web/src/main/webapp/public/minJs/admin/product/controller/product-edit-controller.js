function ProductEditController($scope,$route,$location,$dialog,messageService,ProductDetail,PriceHistory,ProductGroups,CreateProduct,UpdateProduct,ProductCategories,ReportPrograms,ProductList,RemoveProduct,RestoreProduct,DosageUnits,ProductForms){$scope.products={};$scope.editProduct={};$scope.product={};$scope.creationError="";$scope.title="Products";$scope.AddEditMode="";$scope.programProductsCost=[];$scope.AddEditMode=true;$scope.title="Edit Product";$scope.$parent.message="";ReportPrograms.get(function(data){var tmp=
data.programs;$scope.programs=data.programs});$scope.disableAllFields=function(){$(".form-group").find(":input").attr("disabled","disabled")};$scope.showConfirmProductDeleteWindow=function(productUnderDelete){var dialogOpts={id:"deleteProductDialog",header:messageService.get("Delete product"),body:"The product "+productUnderDelete.fullName+" will be marked as inactive in the system. Are you sure?"};$scope.productUnderDelete=productUnderDelete;OpenLmisDialog.newDialog(dialogOpts,$scope.deleteProductCallBack,
$dialog,messageService)};$scope.deleteProductCallBack=function(result){if(!result){$scope.productsBackupMap[$scope.productUnderDelete.id].deleted=false;return}RemoveProduct.get({id:$scope.editProduct.id},$scope.product,function(data){$scope.message=data.success;setTimeout(function(){$scope.$apply(function(){$scope.productsList=data.productsList;$scope.filteredProducts=data.productList;$scope.message=""})},2E3);$location.path("");$scope.$parent.message="The product was marked as deleted."})};$scope.showConfirmProductRestoreWindow=
function(productUnderRestore){var dialogOpts={id:"restoreProductDialog",header:messageService.get("Restore product"),body:messageService.get('"'+productUnderRestore.fullName+'"'+" will be restored. Are you sure?")};$scope.productUnderRestore=productUnderRestore;OpenLmisDialog.newDialog(dialogOpts,$scope.restoreProductCallBack,$dialog,messageService)};$scope.restoreProductCallBack=function(result){if(!result){$scope.productsBackupMap[$scope.productUnderRestore.id].restore=false;return}RestoreProduct.get({id:$scope.productUnderRestore.id},
$scope.product,function(data){$scope.message=data.success;setTimeout(function(){$scope.$apply(function(){$scope.productsList=data.productsList;$scope.filteredProducts=data.productList;$scope.message=""})},2E3);$location.path("");$scope.$parent.message="The product was restored."})};$scope.cancelAddNewProduct=function(product){$scope.$parent.newProductMode=false;$scope.AddEditMode=false;$scope.showErrorForCreate=false};$scope.productLoaded=function(){return!($scope.products==undefined||$scope.products==
null)};ProductCategories.get(function(data){$scope.productCategories=data.productCategoryList});ProductGroups.get(function(data){$scope.productGroups=data.productGroups});DosageUnits.get(function(data){$scope.dosageUnits=data.dosageUnits});ProductForms.get(function(data){$scope.productForms=data.productForms});$scope.YesNo=function(tf){var retval="";if(tf==true)retval="Yes";else retval="No";return retval};$scope.startProductEdit=function(productId){$scope.$parent.editProductMode=true;$scope.title=
"Edit product";$scope.AddEditMode=true;ProductDetail.get({id:productId},function(data){$scope.editProduct=data.product;if($scope.editProduct.active==false)$scope.disableAllFields()});PriceHistory.get({productId:productId},function(data){$scope.priceHistory=data.priceHistory})};$scope.updateProduct=function(){product=$scope.editProduct;$scope.error="";if(editProductForm.$invalid){$scope.showErrorForEdit=true;return}$scope.showErrorForEdit=true;UpdateProduct.update($scope.editProduct,function(data){var returnedProduct=
data.product;$location.path("");$scope.$parent.message="The product record was successfully updated."},function(data){alert(JSON.stringify(data));$scope.creationError=data.message})};$scope.cancelProductEdit=function(productUnderEdit){$location.path("")};$scope.startProductEdit($route.current.params.id)};